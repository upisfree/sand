(function(){var a,b,c,d,e,f,g,h,i;window.w=window.innerWidth,window.h=window.innerHeight,b=Matter.Engine.create(document.body,{world:{gravity:{x:0,y:0},bounds:{min:{x:-(1/0),y:-(1/0)},max:{x:1/0,y:1/0}}},enableSleeping:!0,render:{controller:Matter.RenderPixi,options:{width:window.w,height:window.h,wireframes:!1,background:"#ccc"}}}),Math.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},Math.radiansToDegrees=function(a){return a*(180/Math.PI)},Math.degreesToRadians=function(a){return a*(Math.PI/180)},Math.angleFromVector=function(a,b){return Math.atan2(window.h/2-b,window.w/2-a)-Math.PI/2},e=Matter.Vector,e.fromAngle=function(a){return a-=Math.PI/2,{x:Math.cos(a),y:Math.sin(a)}},Array.prototype.min=function(){return Math.min.apply(null,this)},Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.remove=function(a){var b,c,d;d=[];for(b in this)c=this[b],c.i===a.i?d.push(this.splice(b,1)):d.push(void 0);return d},g=function(a){return Matter.Composite.add(b.world,a)},f={start:function(){return f._setPrefixes(),f._supportGetUserMedia()?navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:!0,googNoiseSuppression:!0,googHighpassFilter:!0,googAutoGainControl:!0}}},f.analyze,f.error):console.log("Can't find navigator.getUserMedia()!")},analyze:function(a){var b,c;return window.AudioContext=window.AudioContext||window.webkitAudioContext,b=new AudioContext,c=b.createMediaStreamSource(a),f.analyser=b.createAnalyser(),f.analyser.fftSize=2048,c.connect(f.analyser)},update:function(){var a,c,d,e,g,i,j;for(a=new Uint8Array(f.analyser.frequencyBinCount),f.analyser.getByteFrequencyData(a),c=0,e=0,i=a.length;i>e;e++)d=a[e],c+=parseFloat(d);for(c/=a.length,b.render.gl.clear(),b.render.gl.lineStyle(1,0,1),j=[],d=g=0;c>=0?c>=g:g>=c;d=c>=0?++g:--g)j.push(b.render.gl.drawCircle(h.body.position.x,h.body.position.y,10*d));return j},error:function(a){return console.log(a)},analyser:null,_setPrefixes:function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia},_supportGetUserMedia:function(){return!!navigator.getUserMedia}},a={walls:function(){var a,b,c,d,e;for(e=[],b=d=0;500>d;b=++d)Math.random()>.5?(c=Math.randomInt(25,75),a=Math.randomInt(150,250)):(c=Math.randomInt(150,250),a=Math.randomInt(25,75)),e.push(g(Matter.Bodies.rectangle(Math.randomInt(2*-window.w,2*window.w),Math.randomInt(2*-window.h,2*window.h),c,a,{isStatic:!0})));return e},stack:function(){return g(Matter.Composites.stack(0,0,15,4,0,0,function(a,b,c,d){var e,f;switch(Math.round(Math.random())){case 0:return Math.random()<.8?Matter.Bodies.rectangle(a,b,Math.randomInt(20,50),Math.randomInt(20,50)):Matter.Bodies.rectangle(a,b,Math.randomInt(80,120),Math.randomInt(20,30));case 1:return e=Math.round(Math.randomInt(1,8)),e=null!=(f=3===e)?f:{4:e},Matter.Bodies.polygon(a,b,e,Math.randomInt(20,50))}}))}},c={enable:function(){return c.pixelate=new PIXI.filters.PixelateFilter,c.color=new PIXI.filters.ColorMatrixFilter,c.color.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b.render.container.filters=[c.pixelate]},disable:function(){return b.render.container.filters=[]},update:function(a){return b.render.container.filters?(c.color.matrix[2]=Math.sin(2*a),c.color.matrix[6]=Math.cos(2*a)):void 0}},d=function(){function a(a,b){this.body=Matter.Bodies.rectangle(a,b,100,100,{mass:100,frictionAir:.25}),this.enableControl(this.body),g(this.body)}return a.prototype.enableControl=function(a){return window.onmousemove=function(b){return a.angle=Math.angleFromVector(b.x,b.y)},window.onkeydown=function(b){var c;switch(c=1.5,b.keyCode){case 87:case 38:return Matter.Body.applyForce(a,{x:0,y:0},Matter.Vector.mult(e.fromAngle(a.angle),c));case 83:case 40:return Matter.Body.applyForce(a,{x:0,y:0},Matter.Vector.neg(Matter.Vector.mult(e.fromAngle(a.angle),c)))}}},a}(),Matter.Engine.run(b),i=0,h=new d(window.w/2,window.h/2),a.stack(),f.start(),b.render.gl=new PIXI.Graphics,setTimeout(function(){return b.render.container.addChild(b.render.gl)},5e3),b.render.options.hasBounds=!0,Matter.Events.on(b,"tick",function(a){return i+=.01,f.update(),Matter.Bounds.shift(b.render.bounds,{x:h.body.position.x-window.w/2,y:h.body.position.y-window.h/2}),c.update(i)})}).call(this);