/**
* matter-dev.min.js 0.8.0-dev 2015-07-03
* http://brm.io/matter-js/
* License: MIT
*/

!function(){var a={},b={};!function(){b._inertiaScale=4;var a=1,c=-1,d=1;b.create=function(a){var b={id:n.nextId(),type:"body",label:"Body",parts:[],angle:0,vertices:z.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1},c=n.extend(b,a);return e(c,a),c},b.nextGroup=function(b){return b?c--:a++},b.nextCategory=function(){return d<<=1};var e=function(a,c){b.set(a,{bounds:a.bounds||w.create(a.vertices),positionPrev:a.positionPrev||y.clone(a.position),anglePrev:a.anglePrev||a.angle,vertices:a.vertices,parts:a.parts||[a],isStatic:a.isStatic,isSleeping:a.isSleeping,parent:a.parent||a}),z.rotate(a.vertices,a.angle,a.position),v.rotate(a.axes,a.angle),w.update(a.bounds,a.vertices,a.velocity),b.set(a,{axes:c.axes||a.axes,area:c.area||a.area,mass:c.mass||a.mass,inertia:c.inertia||a.inertia})};b.set=function(a,c,d){var e;"string"==typeof c&&(e=c,c={},c[e]=d);for(e in c)if(d=c[e],c.hasOwnProperty(e))switch(e){case"isStatic":b.setStatic(a,d);break;case"isSleeping":s.set(a,d);break;case"mass":b.setMass(a,d);break;case"density":b.setDensity(a,d);break;case"inertia":b.setInertia(a,d);break;case"vertices":b.setVertices(a,d);break;case"position":b.setPosition(a,d);break;case"angle":b.setAngle(a,d);break;case"velocity":b.setVelocity(a,d);break;case"angularVelocity":b.setAngularVelocity(a,d);break;case"parts":b.setParts(a,d);break;default:a[e]=d}},b.setStatic=function(a,b){for(var c=0;c<a.parts.length;c++){var d=a.parts[c];d.isStatic=b,b&&(d.restitution=0,d.friction=1,d.mass=d.inertia=d.density=1/0,d.inverseMass=d.inverseInertia=0,d.positionPrev.x=d.position.x,d.positionPrev.y=d.position.y,d.anglePrev=d.angle,d.angularVelocity=0,d.speed=0,d.angularSpeed=0,d.motion=0)}},b.setMass=function(a,b){a.mass=b,a.inverseMass=1/a.mass,a.density=a.mass/a.area},b.setDensity=function(a,c){b.setMass(a,c*a.area),a.density=c},b.setInertia=function(a,b){a.inertia=b,a.inverseInertia=1/a.inertia},b.setVertices=function(a,c){c[0].body===a?a.vertices=c:a.vertices=z.create(c,a),a.axes=v.fromVertices(a.vertices),a.area=z.area(a.vertices),b.setMass(a,a.density*a.area);var d=z.centre(a.vertices);z.translate(a.vertices,d,-1),b.setInertia(a,b._inertiaScale*z.inertia(a.vertices,a.mass)),z.translate(a.vertices,a.position),w.update(a.bounds,a.vertices,a.velocity)},b.setParts=function(a,c,d){var e;for(c=c.slice(0),a.parts.length=0,a.parts.push(a),a.parent=a,e=0;e<c.length;e++){var g=c[e];g!==a&&(g.parent=a,a.parts.push(g))}if(1!==a.parts.length){if(d="undefined"!=typeof d?d:!0){var h=[];for(e=0;e<c.length;e++)h=h.concat(c[e].vertices);z.clockwiseSort(h);var i=z.hull(h),j=z.centre(i);b.setVertices(a,i),z.translate(a.vertices,j)}var k=f(a);a.area=k.area,a.parent=a,a.position.x=k.centre.x,a.position.y=k.centre.y,a.positionPrev.x=k.centre.x,a.positionPrev.y=k.centre.y,b.setMass(a,k.mass),b.setInertia(a,k.inertia),b.setPosition(a,k.centre)}},b.setPosition=function(a,b){var c=y.sub(b,a.position);a.positionPrev.x+=c.x,a.positionPrev.y+=c.y;for(var d=0;d<a.parts.length;d++){var e=a.parts[d];e.position.x+=c.x,e.position.y+=c.y,z.translate(e.vertices,c),w.update(e.bounds,e.vertices,a.velocity)}},b.setAngle=function(a,b){var c=b-a.angle;a.anglePrev+=c;for(var d=0;d<a.parts.length;d++){var e=a.parts[d];e.angle+=c,z.rotate(e.vertices,c,a.position),v.rotate(e.axes,c),w.update(e.bounds,e.vertices,a.velocity),d>0&&y.rotateAbout(e.position,c,a.position,e.position)}},b.setVelocity=function(a,b){a.positionPrev.x=a.position.x-b.x,a.positionPrev.y=a.position.y-b.y,a.velocity.x=b.x,a.velocity.y=b.y,a.speed=y.magnitude(a.velocity)},b.setAngularVelocity=function(a,b){a.anglePrev=a.angle-b,a.angularVelocity=b,a.angularSpeed=Math.abs(a.angularVelocity)},b.translate=function(a,c){b.setPosition(a,y.add(a.position,c))},b.rotate=function(a,c){b.setAngle(a,a.angle+c)},b.scale=function(a,c,d,e){for(var g=0;g<a.parts.length;g++){var h=a.parts[g];z.scale(h.vertices,c,d,a.position),h.axes=v.fromVertices(h.vertices),a.isStatic||(h.area=z.area(h.vertices),b.setMass(h,a.density*h.area),z.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),b.setInertia(h,z.inertia(h.vertices,h.mass)),z.translate(h.vertices,{x:h.position.x,y:h.position.y})),w.update(h.bounds,h.vertices,a.velocity)}if(!a.isStatic){var i=f(a);a.area=i.area,b.setMass(a,i.mass),b.setInertia(a,i.inertia)}},b.update=function(a,b,c,d){var e=Math.pow(b*c*a.timeScale,2),f=1-a.frictionAir*c*a.timeScale,g=a.position.x-a.positionPrev.x,h=a.position.y-a.positionPrev.y;a.velocity.x=g*f*d+a.force.x/a.mass*e,a.velocity.y=h*f*d+a.force.y/a.mass*e,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.position.x+=a.velocity.x,a.position.y+=a.velocity.y,a.angularVelocity=(a.angle-a.anglePrev)*f*d+a.torque/a.inertia*e,a.anglePrev=a.angle,a.angle+=a.angularVelocity,a.speed=y.magnitude(a.velocity),a.angularSpeed=Math.abs(a.angularVelocity);for(var i=0;i<a.parts.length;i++){var j=a.parts[i];z.translate(j.vertices,a.velocity),i>0&&(j.position.x+=a.velocity.x,j.position.y+=a.velocity.y),0!==a.angularVelocity&&(z.rotate(j.vertices,a.angularVelocity,a.position),v.rotate(j.axes,a.angularVelocity),i>0&&y.rotateAbout(j.position,a.angularVelocity,a.position,j.position)),w.update(j.bounds,j.vertices,a.velocity)}},b.applyForce=function(a,b,c){a.force.x+=c.x,a.force.y+=c.y;var d={x:b.x-a.position.x,y:b.y-a.position.y};a.torque+=(d.x*c.y-d.y*c.x)*a.inverseInertia};var f=function(a){for(var b={mass:0,area:0,inertia:0,centre:{x:0,y:0}},c=1===a.parts.length?0:1;c<a.parts.length;c++){var d=a.parts[c];b.mass+=d.mass,b.area+=d.area,b.inertia+=d.inertia,b.centre=y.add(b.centre,y.mult(d.position,d.mass!==1/0?d.mass:1))}return b.centre=y.div(b.centre,b.mass!==1/0?b.mass:a.parts.length),b}}();var c={};!function(){c.create=function(a){return n.extend({id:n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite"},a)},c.setModified=function(a,b,d,e){if(a.isModified=b,d&&a.parent&&c.setModified(a.parent,b,d,e),e)for(var f=0;f<a.composites.length;f++){var g=a.composites[f];c.setModified(g,b,d,e)}},c.add=function(a,b){var d=[].concat(b);p.trigger(a,"beforeAdd",{object:b});for(var e=0;e<d.length;e++){var f=d[e];switch(f.type){case"body":if(f.parent!==f){n.log("Composite.add: skipped adding a compound body part (you must add its parent instead)","warn");break}c.addBody(a,f);break;case"constraint":c.addConstraint(a,f);break;case"composite":c.addComposite(a,f);break;case"mouseConstraint":c.addConstraint(a,f.constraint)}}return p.trigger(a,"afterAdd",{object:b}),a},c.remove=function(a,b,d){var e=[].concat(b);p.trigger(a,"beforeRemove",{object:b});for(var f=0;f<e.length;f++){var g=e[f];switch(g.type){case"body":c.removeBody(a,g,d);break;case"constraint":c.removeConstraint(a,g,d);break;case"composite":c.removeComposite(a,g,d);break;case"mouseConstraint":c.removeConstraint(a,g.constraint)}}return p.trigger(a,"afterRemove",{object:b}),a},c.addComposite=function(a,b){return a.composites.push(b),b.parent=a,c.setModified(a,!0,!0,!1),a},c.removeComposite=function(a,b,d){var e=n.indexOf(a.composites,b);if(-1!==e&&(c.removeCompositeAt(a,e),c.setModified(a,!0,!0,!1)),d)for(var f=0;f<a.composites.length;f++)c.removeComposite(a.composites[f],b,!0);return a},c.removeCompositeAt=function(a,b){return a.composites.splice(b,1),c.setModified(a,!0,!0,!1),a},c.addBody=function(a,b){return a.bodies.push(b),c.setModified(a,!0,!0,!1),a},c.removeBody=function(a,b,d){var e=n.indexOf(a.bodies,b);if(-1!==e&&(c.removeBodyAt(a,e),c.setModified(a,!0,!0,!1)),d)for(var f=0;f<a.composites.length;f++)c.removeBody(a.composites[f],b,!0);return a},c.removeBodyAt=function(a,b){return a.bodies.splice(b,1),c.setModified(a,!0,!0,!1),a},c.addConstraint=function(a,b){return a.constraints.push(b),c.setModified(a,!0,!0,!1),a},c.removeConstraint=function(a,b,d){var e=n.indexOf(a.constraints,b);if(-1!==e&&c.removeConstraintAt(a,e),d)for(var f=0;f<a.composites.length;f++)c.removeConstraint(a.composites[f],b,!0);return a},c.removeConstraintAt=function(a,b){return a.constraints.splice(b,1),c.setModified(a,!0,!0,!1),a},c.clear=function(a,b,d){if(d)for(var e=0;e<a.composites.length;e++)c.clear(a.composites[e],b,!0);return b?a.bodies=a.bodies.filter(function(a){return a.isStatic}):a.bodies.length=0,a.constraints.length=0,a.composites.length=0,c.setModified(a,!0,!0,!1),a},c.allBodies=function(a){for(var b=[].concat(a.bodies),d=0;d<a.composites.length;d++)b=b.concat(c.allBodies(a.composites[d]));return b},c.allConstraints=function(a){for(var b=[].concat(a.constraints),d=0;d<a.composites.length;d++)b=b.concat(c.allConstraints(a.composites[d]));return b},c.allComposites=function(a){for(var b=[].concat(a.composites),d=0;d<a.composites.length;d++)b=b.concat(c.allComposites(a.composites[d]));return b},c.get=function(a,b,d){var e,f;switch(d){case"body":e=c.allBodies(a);break;case"constraint":e=c.allConstraints(a);break;case"composite":e=c.allComposites(a).concat(a)}return e?(f=e.filter(function(a){return a.id.toString()===b.toString()}),0===f.length?null:f[0]):null},c.move=function(a,b,d){return c.remove(a,b),c.add(d,b),a},c.rebase=function(a){for(var b=c.allBodies(a).concat(c.allConstraints(a)).concat(c.allComposites(a)),d=0;d<b.length;d++)b[d].id=n.nextId();return c.setModified(a,!0,!0,!1),a},c.translate=function(a,d,e){for(var f=e?c.allBodies(a):a.bodies,g=0;g<f.length;g++)b.translate(f[g],d);return c.setModified(a,!0,!0,!1),a},c.rotate=function(a,d,e,f){for(var g=Math.cos(d),h=Math.sin(d),i=f?c.allBodies(a):a.bodies,j=0;j<i.length;j++){var k=i[j],l=k.position.x-e.x,m=k.position.y-e.y;b.setPosition(k,{x:e.x+(l*g-m*h),y:e.y+(l*h+m*g)}),b.rotate(k,d)}return c.setModified(a,!0,!0,!1),a},c.scale=function(a,d,e,f,g){for(var h=g?c.allBodies(a):a.bodies,i=0;i<h.length;i++){var j=h[i],k=j.position.x-f.x,l=j.position.y-f.y;b.setPosition(j,{x:f.x+k*d,y:f.y+l*e}),b.scale(j,d,e)}return c.setModified(a,!0,!0,!1),a}}();var d={};!function(){d.create=function(a){var b=c.create(),d={label:"World",gravity:{x:0,y:1},bounds:{min:{x:-(1/0),y:-(1/0)},max:{x:1/0,y:1/0}}};return n.extend(b,d,a)}}();var e={};!function(){e.create=function(a){return{id:e.id(a),vertex:a,normalImpulse:0,tangentImpulse:0}},e.id=function(a){return a.body.id+"_"+a.index}}();var f={};!function(){f.collisions=function(a,b){for(var c=[],d=b.pairs.table,e=b.metrics,g=0;g<a.length;g++){var i=a[g][0],j=a[g][1];if((!i.isStatic&&!i.isSleeping||!j.isStatic&&!j.isSleeping)&&f.canCollide(i.collisionFilter,j.collisionFilter)&&(e.midphaseTests+=1,w.overlaps(i.bounds,j.bounds)))for(var k=i.parts.length>1?1:0;k<i.parts.length;k++)for(var m=i.parts[k],n=j.parts.length>1?1:0;n<j.parts.length;n++){var o=j.parts[n];if(m===i&&o===j||w.overlaps(m.bounds,o.bounds)){var p,q=h.id(m,o),r=d[q];p=r&&r.isActive?r.collision:null;var s=l.collides(m,o,p);e.narrowphaseTests+=1,s.reused&&(e.narrowReuseCount+=1),s.collided&&(c.push(s),e.narrowDetections+=1)}}}return c},f.bruteForce=function(a,b){for(var c=[],d=b.pairs.table,e=b.metrics,g=0;g<a.length;g++)for(var i=g+1;i<a.length;i++){var j=a[g],k=a[i];if((!j.isStatic&&!j.isSleeping||!k.isStatic&&!k.isSleeping)&&f.canCollide(j.collisionFilter,k.collisionFilter)&&(e.midphaseTests+=1,w.overlaps(j.bounds,k.bounds))){var m,n=h.id(j,k),o=d[n];m=o&&o.isActive?o.collision:null;var p=l.collides(j,k,m);e.narrowphaseTests+=1,p.reused&&(e.narrowReuseCount+=1),p.collided&&(c.push(p),e.narrowDetections+=1)}}return c},f.canCollide=function(a,b){return a.group===b.group&&0!==a.group?a.group>0:0!==(a.mask&b.category)&&0!==(b.mask&a.category)}}();var g={};!function(){g.create=function(a){var b={controller:g,detector:f.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return n.extend(b,a)},g.update=function(c,f,g,h){var l,m,n,o,p,q=g.world,r=c.buckets,s=!1,t=g.metrics;for(t.broadphaseTests=0,l=0;l<f.length;l++){var u=f[l];if((!u.isSleeping||h)&&!(u.bounds.max.x<0||u.bounds.min.x>q.bounds.width||u.bounds.max.y<0||u.bounds.min.y>q.bounds.height)){var v=b(c,u);if(!u.region||v.id!==u.region.id||h){t.broadphaseTests+=1,(!u.region||h)&&(u.region=v);var w=a(v,u.region);for(m=w.startCol;m<=w.endCol;m++)for(n=w.startRow;n<=w.endRow;n++){p=d(m,n),o=r[p];var x=m>=v.startCol&&m<=v.endCol&&n>=v.startRow&&n<=v.endRow,y=m>=u.region.startCol&&m<=u.region.endCol&&n>=u.region.startRow&&n<=u.region.endRow;!x&&y&&y&&o&&j(c,o,u),(u.region===v||x&&!y||h)&&(o||(o=e(r,p)),i(c,o,u))}u.region=v,s=!0}}}s&&(c.pairsList=k(c))},g.clear=function(a){a.buckets={},a.pairs={},a.pairsList=[]};var a=function(a,b){var d=Math.min(a.startCol,b.startCol),e=Math.max(a.endCol,b.endCol),f=Math.min(a.startRow,b.startRow),g=Math.max(a.endRow,b.endRow);return c(d,e,f,g)},b=function(a,b){var d=b.bounds,e=Math.floor(d.min.x/a.bucketWidth),f=Math.floor(d.max.x/a.bucketWidth),g=Math.floor(d.min.y/a.bucketHeight),h=Math.floor(d.max.y/a.bucketHeight);return c(e,f,g,h)},c=function(a,b,c,d){return{id:a+","+b+","+c+","+d,startCol:a,endCol:b,startRow:c,endRow:d}},d=function(a,b){return a+","+b},e=function(a,b){var c=a[b]=[];return c},i=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];if(!(c.id===e.id||c.isStatic&&e.isStatic)){var f=h.id(c,e),g=a.pairs[f];g?g[2]+=1:a.pairs[f]=[c,e,1]}}b.push(c)},j=function(a,b,c){b.splice(n.indexOf(b,c),1);for(var d=0;d<b.length;d++){var e=b[d],f=h.id(c,e),g=a.pairs[f];g&&(g[2]-=1)}},k=function(a){var b,c,d=[];b=n.keys(a.pairs);for(var e=0;e<b.length;e++)c=a.pairs[b[e]],c[2]>0?d.push(c):delete a.pairs[b[e]];return d}}();var h={};!function(){h.create=function(a,b){var c=a.bodyA,d=a.bodyB,e=a.parentA,f=a.parentB,g={id:h.id(c,d),bodyA:c,bodyB:d,contacts:{},activeContacts:[],separation:0,isActive:!0,timeCreated:b,timeUpdated:b,inverseMass:e.inverseMass+f.inverseMass,friction:Math.min(e.friction,f.friction),frictionStatic:Math.max(e.frictionStatic,f.frictionStatic),restitution:Math.max(e.restitution,f.restitution),slop:Math.max(e.slop,f.slop)};return h.update(g,a,b),g},h.update=function(a,b,c){var d=a.contacts,f=b.supports,g=a.activeContacts,i=b.parentA,j=b.parentB;if(a.collision=b,a.inverseMass=i.inverseMass+j.inverseMass,a.friction=Math.min(i.friction,j.friction),a.frictionStatic=Math.max(i.frictionStatic,j.frictionStatic),a.restitution=Math.max(i.restitution,j.restitution),a.slop=Math.max(i.slop,j.slop),g.length=0,b.collided){for(var k=0;k<f.length;k++){var l=f[k],m=e.id(l),n=d[m];n?g.push(n):g.push(d[m]=e.create(l))}a.separation=b.depth,h.setActive(a,!0,c)}else a.isActive===!0&&h.setActive(a,!1,c)},h.setActive=function(a,b,c){b?(a.isActive=!0,a.timeUpdated=c):(a.isActive=!1,a.activeContacts.length=0)},h.id=function(a,b){return a.id<b.id?a.id+"_"+b.id:b.id+"_"+a.id}}();var i={};!function(){var a=1e3;i.create=function(a){return n.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},i.update=function(a,b,c){var d,e,f,g,i=a.list,j=a.table,k=a.collisionStart,l=a.collisionEnd,m=a.collisionActive,o=[];for(k.length=0,l.length=0,m.length=0,g=0;g<b.length;g++)d=b[g],d.collided&&(e=h.id(d.bodyA,d.bodyB),o.push(e),f=j[e],f?(f.isActive?m.push(f):k.push(f),h.update(f,d,c)):(f=h.create(d,c),j[e]=f,k.push(f),i.push(f)));for(g=0;g<i.length;g++)f=i[g],f.isActive&&-1===n.indexOf(o,f.id)&&(h.setActive(f,!1,c),l.push(f))},i.removeOld=function(b,c){var d,e,f,g,h=b.list,i=b.table,j=[];for(g=0;g<h.length;g++)d=h[g],e=d.collision,e.bodyA.isSleeping||e.bodyB.isSleeping?d.timeUpdated=c:c-d.timeUpdated>a&&j.push(g);for(g=0;g<j.length;g++)f=j[g]-g,d=h[f],delete i[d.id],h.splice(f,1)},i.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}}();var j={};!function(){j.ray=function(a,b,c,d){d=d||1e-100;for(var e=y.angle(b,c),f=y.magnitude(y.sub(b,c)),g=.5*(c.x+b.x),h=.5*(c.y+b.y),i=t.rectangle(g,h,f,d,{angle:e}),j=[],k=0;k<a.length;k++){var m=a[k];if(w.overlaps(m.bounds,i.bounds))for(var n=1===m.parts.length?0:1;n<m.parts.length;n++){var o=m.parts[n];if(w.overlaps(o.bounds,i.bounds)){var p=l.collides(o,i);if(p.collided){p.body=p.bodyA=p.bodyB=m,j.push(p);break}}}}return j},j.region=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=a[e],g=w.overlaps(f.bounds,b);(g&&!c||!g&&c)&&d.push(f)}return d},j.point=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];if(w.contains(e.bounds,b))for(var f=1===e.parts.length?0:1;f<e.parts.length;f++){var g=e.parts[f];if(w.contains(g.bounds,b)&&z.contains(g.vertices,b)){c.push(e);break}}}return c}}();var k={};!function(){k._restingThresh=4,k._positionDampen=.9,k._positionWarming=.8,k._frictionNormalMultiplier=5,k.preSolvePosition=function(a){var b,c,d;for(b=0;b<a.length;b++)c=a[b],c.isActive&&(d=c.activeContacts.length,c.collision.parentA.totalContacts+=d,c.collision.parentB.totalContacts+=d)},k.solvePosition=function(a,b){var c,d,e,f,g,h,i,j,l,m=y._temp[0],n=y._temp[1],o=y._temp[2],p=y._temp[3];for(c=0;c<a.length;c++)d=a[c],d.isActive&&(e=d.collision,f=e.parentA,g=e.parentB,h=e.normal,i=y.sub(y.add(g.positionImpulse,g.position,m),y.add(f.positionImpulse,y.sub(g.position,e.penetration,n),o),p),d.separation=y.dot(h,i));for(c=0;c<a.length;c++)d=a[c],!d.isActive||d.separation<0||(e=d.collision,f=e.parentA,g=e.parentB,h=e.normal,l=(d.separation-d.slop)*b,(f.isStatic||g.isStatic)&&(l*=2),f.isStatic||f.isSleeping||(j=k._positionDampen/f.totalContacts,f.positionImpulse.x+=h.x*l*j,f.positionImpulse.y+=h.y*l*j),g.isStatic||g.isSleeping||(j=k._positionDampen/g.totalContacts,g.positionImpulse.x-=h.x*l*j,g.positionImpulse.y-=h.y*l*j))},k.postSolvePosition=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.totalContacts=0,0!==c.positionImpulse.x||0!==c.positionImpulse.y){for(var d=0;d<c.parts.length;d++){var e=c.parts[d];z.translate(e.vertices,c.positionImpulse),w.update(e.bounds,e.vertices,c.velocity),e.position.x+=c.positionImpulse.x,e.position.y+=c.positionImpulse.y}c.positionPrev.x+=c.positionImpulse.x,c.positionPrev.y+=c.positionImpulse.y,y.dot(c.positionImpulse,c.velocity)<0?(c.positionImpulse.x=0,c.positionImpulse.y=0):(c.positionImpulse.x*=k._positionWarming,c.positionImpulse.y*=k._positionWarming)}}},k.preSolveVelocity=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=y._temp[0],q=y._temp[1];for(b=0;b<a.length;b++)if(d=a[b],d.isActive)for(e=d.activeContacts,f=d.collision,g=f.parentA,h=f.parentB,i=f.normal,j=f.tangent,c=0;c<e.length;c++)k=e[c],l=k.vertex,m=k.normalImpulse,n=k.tangentImpulse,(0!==m||0!==n)&&(p.x=i.x*m+j.x*n,p.y=i.y*m+j.y*n,g.isStatic||g.isSleeping||(o=y.sub(l,g.position,q),g.positionPrev.x+=p.x*g.inverseMass,g.positionPrev.y+=p.y*g.inverseMass,g.anglePrev+=y.cross(o,p)*g.inverseInertia),h.isStatic||h.isSleeping||(o=y.sub(l,h.position,q),h.positionPrev.x-=p.x*h.inverseMass,h.positionPrev.y-=p.y*h.inverseMass,h.anglePrev-=y.cross(o,p)*h.inverseInertia))},k.solveVelocity=function(a,b){for(var c=b*b,d=y._temp[0],e=y._temp[1],f=y._temp[2],g=y._temp[3],h=y._temp[4],i=y._temp[5],j=0;j<a.length;j++){var l=a[j];if(l.isActive){var m=l.collision,o=m.parentA,p=m.parentB,q=m.normal,r=m.tangent,s=l.activeContacts,t=1/s.length;o.velocity.x=o.position.x-o.positionPrev.x,o.velocity.y=o.position.y-o.positionPrev.y,p.velocity.x=p.position.x-p.positionPrev.x,p.velocity.y=p.position.y-p.positionPrev.y,o.angularVelocity=o.angle-o.anglePrev,p.angularVelocity=p.angle-p.anglePrev;for(var u=0;u<s.length;u++){var v=s[u],w=v.vertex,x=y.sub(w,o.position,e),z=y.sub(w,p.position,f),A=y.add(o.velocity,y.mult(y.perp(x),o.angularVelocity),g),B=y.add(p.velocity,y.mult(y.perp(z),p.angularVelocity),h),C=y.sub(A,B,i),D=y.dot(q,C),E=y.dot(r,C),F=Math.abs(E),G=n.sign(E),H=(1+l.restitution)*D,I=n.clamp(l.separation+D,0,1)*k._frictionNormalMultiplier,J=E,K=1/0;F>l.friction*l.frictionStatic*I*c&&(J=l.friction*G*c,K=F);var L=y.cross(x,q),M=y.cross(z,q),N=o.inverseMass+p.inverseMass+o.inverseInertia*L*L+p.inverseInertia*M*M;if(H*=t/N,J*=t/(1+N),0>D&&D*D>k._restingThresh*c)v.normalImpulse=0,v.tangentImpulse=0;else{var O=v.normalImpulse;v.normalImpulse=Math.min(v.normalImpulse+H,0),H=v.normalImpulse-O;var P=v.tangentImpulse;v.tangentImpulse=n.clamp(v.tangentImpulse+J,-K,K),J=v.tangentImpulse-P}d.x=q.x*H+r.x*J,d.y=q.y*H+r.y*J,o.isStatic||o.isSleeping||(o.positionPrev.x+=d.x*o.inverseMass,o.positionPrev.y+=d.y*o.inverseMass,o.anglePrev+=y.cross(x,d)*o.inverseInertia),p.isStatic||p.isSleeping||(p.positionPrev.x-=d.x*p.inverseMass,p.positionPrev.y-=d.y*p.inverseMass,p.anglePrev-=y.cross(z,d)*p.inverseInertia)}}}}}();var l={};!function(){l.collides=function(b,d,e){var f,g,h,i,j=e,k=!1;if(j){var l=b.parent,m=d.parent,n=l.speed*l.speed+l.angularSpeed*l.angularSpeed+m.speed*m.speed+m.angularSpeed*m.angularSpeed;k=j&&j.collided&&.2>n,i=j}else i={collided:!1,bodyA:b,bodyB:d};if(j&&k){var o=i.axisBody,p=o===b?d:b,q=[o.axes[j.axisNumber]];if(h=a(o.vertices,p.vertices,q),i.reused=!0,h.overlap<=0)return i.collided=!1,i}else{if(f=a(b.vertices,d.vertices,b.axes),f.overlap<=0)return i.collided=!1,i;if(g=a(d.vertices,b.vertices,d.axes),g.overlap<=0)return i.collided=!1,i;f.overlap<g.overlap?(h=f,i.axisBody=b):(h=g,i.axisBody=d),i.axisNumber=h.axisNumber}i.bodyA=b.id<d.id?b:d,i.bodyB=b.id<d.id?d:b,i.collided=!0,i.normal=h.axis,i.depth=h.overlap,i.parentA=i.bodyA.parent,i.parentB=i.bodyB.parent,b=i.bodyA,d=i.bodyB,y.dot(i.normal,y.sub(d.position,b.position))>0&&(i.normal=y.neg(i.normal)),i.tangent=y.perp(i.normal),i.penetration={x:i.normal.x*i.depth,y:i.normal.y*i.depth};var r=c(b,d,i.normal),s=i.supports||[];if(s.length=0,z.contains(b.vertices,r[0])&&s.push(r[0]),z.contains(b.vertices,r[1])&&s.push(r[1]),s.length<2){var t=c(d,b,y.neg(i.normal));z.contains(d.vertices,t[0])&&s.push(t[0]),s.length<2&&z.contains(d.vertices,t[1])&&s.push(t[1])}return s.length<1&&(s=[r[0]]),i.supports=s,i};var a=function(a,c,d){for(var e,f,g=y._temp[0],h=y._temp[1],i={overlap:Number.MAX_VALUE},j=0;j<d.length;j++){if(f=d[j],b(g,a,f),b(h,c,f),e=Math.min(g.max-h.min,h.max-g.min),0>=e)return i.overlap=e,i;e<i.overlap&&(i.overlap=e,i.axis=f,i.axisNumber=j)}return i},b=function(a,b,c){for(var d=y.dot(b[0],c),e=d,f=1;f<b.length;f+=1){var g=y.dot(b[f],c);g>e?e=g:d>g&&(d=g)}a.min=d,a.max=e},c=function(a,b,c){for(var d,e,f,g,h=Number.MAX_VALUE,i=y._temp[0],j=b.vertices,k=a.position,l=0;l<j.length;l++)e=j[l],i.x=e.x-k.x,i.y=e.y-k.y,d=-y.dot(c,i),h>d&&(h=d,f=e);var m=f.index-1>=0?f.index-1:j.length-1;e=j[m],i.x=e.x-k.x,i.y=e.y-k.y,h=-y.dot(c,i),g=e;var n=(f.index+1)%j.length;return e=j[n],i.x=e.x-k.x,i.y=e.y-k.y,d=-y.dot(c,i),h>d&&(g=e),[f,g]}}();var m={};!function(){var a=1e-6,b=.001;m.create=function(b){var c=b;c.bodyA&&!c.pointA&&(c.pointA={x:0,y:0}),c.bodyB&&!c.pointB&&(c.pointB={x:0,y:0});var d=c.bodyA?y.add(c.bodyA.position,c.pointA):c.pointA,e=c.bodyB?y.add(c.bodyB.position,c.pointB):c.pointB,f=y.magnitude(y.sub(d,e));return c.length=c.length||f||a,c.id=c.id||n.nextId(),c.label=c.label||"Constraint",c.type="constraint",c.stiffness=c.stiffness||1,c.angularStiffness=c.angularStiffness||0,c.angleA=c.bodyA?c.bodyA.angle:c.angleA,c.angleB=c.bodyB?c.bodyB.angle:c.angleB,c},m.solveAll=function(a,b){for(var c=0;c<a.length;c++)m.solve(a[c],b)},m.solve=function(c,d){var e=c.bodyA,f=c.bodyB,g=c.pointA,h=c.pointB;e&&!e.isStatic&&(c.pointA=y.rotate(g,e.angle-c.angleA),c.angleA=e.angle),f&&!f.isStatic&&(c.pointB=y.rotate(h,f.angle-c.angleB),c.angleB=f.angle);var i=g,j=h;if(e&&(i=y.add(e.position,g)),f&&(j=y.add(f.position,h)),i&&j){var k=y.sub(i,j),l=y.magnitude(k);0===l&&(l=a);var m=(l-c.length)/l,o=y.div(k,l),p=y.mult(k,.5*m*c.stiffness*d*d);if(!(Math.abs(1-l/c.length)<b*d)){var q,r,t,u,v,w,x,z;e&&!e.isStatic?(t={x:i.x-e.position.x+p.x,y:i.y-e.position.y+p.y},e.velocity.x=e.position.x-e.positionPrev.x,e.velocity.y=e.position.y-e.positionPrev.y,e.angularVelocity=e.angle-e.anglePrev,q=y.add(e.velocity,y.mult(y.perp(t),e.angularVelocity)),v=y.dot(t,o),x=e.inverseMass+e.inverseInertia*v*v):(q={x:0,y:0},x=e?e.inverseMass:0),f&&!f.isStatic?(u={x:j.x-f.position.x-p.x,y:j.y-f.position.y-p.y},f.velocity.x=f.position.x-f.positionPrev.x,f.velocity.y=f.position.y-f.positionPrev.y,f.angularVelocity=f.angle-f.anglePrev,r=y.add(f.velocity,y.mult(y.perp(u),f.angularVelocity)),w=y.dot(u,o),z=f.inverseMass+f.inverseInertia*w*w):(r={x:0,y:0},z=f?f.inverseMass:0);var A=y.sub(r,q),B=y.dot(o,A)/(x+z);B>0&&(B=0);var C,D={x:o.x*B,y:o.y*B};e&&!e.isStatic&&(C=y.cross(t,D)*e.inverseInertia*(1-c.angularStiffness),s.set(e,!1),C=n.clamp(C,-.01,.01),e.constraintImpulse.x-=p.x,e.constraintImpulse.y-=p.y,e.constraintImpulse.angle+=C,e.position.x-=p.x,e.position.y-=p.y,e.angle+=C),f&&!f.isStatic&&(C=y.cross(u,D)*f.inverseInertia*(1-c.angularStiffness),s.set(f,!1),C=n.clamp(C,-.01,.01),f.constraintImpulse.x+=p.x,f.constraintImpulse.y+=p.y,f.constraintImpulse.angle-=C,f.position.x+=p.x,f.position.y+=p.y,f.angle-=C)}}},m.postSolveAll=function(a){for(var b=0;b<a.length;b++){for(var c=a[b],d=c.constraintImpulse,e=0;e<c.parts.length;e++){var f=c.parts[e];z.translate(f.vertices,d),e>0&&(f.position.x+=d.x,f.position.y+=d.y),0!==d.angle&&(z.rotate(f.vertices,d.angle,c.position),v.rotate(f.axes,d.angle),e>0&&y.rotateAbout(f.position,d.angle,c.position,f.position)),w.update(f.bounds,f.vertices)}d.angle=0,d.x=0,d.y=0}}}();var n={};!function(){n._nextId=0,n._seed=0,n.extend=function(a,b){var c,d,e;"boolean"==typeof b?(c=2,e=b):(c=1,e=!0),d=Array.prototype.slice.call(arguments,c);for(var f=0;f<d.length;f++){var g=d[f];if(g)for(var h in g)e&&g[h]&&g[h].constructor===Object?a[h]&&a[h].constructor!==Object?a[h]=g[h]:(a[h]=a[h]||{},n.extend(a[h],e,g[h])):a[h]=g[h]}return a},n.clone=function(a,b){return n.extend({},b,a)},n.keys=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)b.push(c);return b},n.values=function(a){var b=[];if(Object.keys){for(var c=Object.keys(a),d=0;d<c.length;d++)b.push(a[c[d]]);return b}for(var e in a)b.push(a[e]);return b},n.shadeColor=function(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)},n.shuffle=function(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(n.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a},n.choose=function(a){return a[Math.floor(n.random()*a.length)]},n.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},n.clamp=function(a,b,c){return b>a?b:a>c?c:a},n.sign=function(a){return 0>a?-1:1},n.now=function(){return Date.now()},n.random=function(b,c){return b="undefined"!=typeof b?b:0,c="undefined"!=typeof c?c:1,b+a()*(c-b)},n.colorToNumber=function(a){return a=a.replace("#",""),3==a.length&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)),parseInt(a,16)},n.log=function(a,b){if(console&&console.log&&console.warn)switch(b){case"warn":console.warn("Matter.js:",a);break;case"error":console.log("Matter.js:",a)}},n.nextId=function(){return n._nextId++},n.indexOf=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1};var a=function(){return n._seed=(9301*n._seed+49297)%233280,n._seed/233280}}();var o={};!function(){var a=60,e=1e3/a;o.create=function(b){var c={enabled:!0,positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],timing:{fps:a,timestamp:0,delta:e,correction:1,deltaMin:1e3/a,deltaMax:1e3/(.5*a),timeScale:1,isFixed:!1,frameRequestId:0},broadphase:{controller:g}},f=n.extend(c,b);return f.world=d.create(f.world),f.pairs=i.create(),f.broadphase=f.broadphase.controller.create(f.broadphase),f.metrics=f.metrics||{extended:!1},f.metrics=f.metrics||q.create(),f},o.update=function(a,b,d){d="undefined"!=typeof d?d:1;var e,g=a.world,l=a.timing,n=a.broadphase,o=[];l.timestamp+=b*l.timeScale,l.correction=d;var r={timestamp:a.timing.timestamp};p.trigger(a,"beforeUpdate",r);var t=c.allBodies(g),u=c.allConstraints(g);for(q.reset(a.metrics),a.enableSleeping&&s.update(t,l.timeScale),h(t,g.gravity),j(t,b,l.timeScale,d,g.bounds),e=0;e<a.constraintIterations;e++)m.solveAll(u,l.timeScale);m.postSolveAll(t),n.controller?(g.isModified&&n.controller.clear(n),n.controller.update(n,t,a,g.isModified),o=n.pairsList):o=t;var v=n.detector(o,a),w=a.pairs,x=l.timestamp;for(i.update(w,v,x),i.removeOld(w,x),a.enableSleeping&&s.afterCollisions(w.list,l.timeScale),w.collisionStart.length>0&&p.trigger(a,"collisionStart",{pairs:w.collisionStart}),k.preSolvePosition(w.list),e=0;e<a.positionIterations;e++)k.solvePosition(w.list,l.timeScale);for(k.postSolvePosition(t),k.preSolveVelocity(w.list),e=0;e<a.velocityIterations;e++)k.solveVelocity(w.list,l.timeScale);return w.collisionActive.length>0&&p.trigger(a,"collisionActive",{pairs:w.collisionActive}),w.collisionEnd.length>0&&p.trigger(a,"collisionEnd",{pairs:w.collisionEnd}),q.update(a.metrics,a),f(t),g.isModified&&c.setModified(g,!1,!1,!0),p.trigger(a,"afterUpdate",r),a},o.merge=function(a,b){if(n.extend(a,b),b.world){a.world=b.world,o.clear(a);for(var d=c.allBodies(a.world),e=0;e<d.length;e++){var f=d[e];s.set(f,!1),f.id=n.nextId()}}},o.clear=function(a){var b=a.world;i.clear(a.pairs);var d=a.broadphase;if(d.controller){var e=c.allBodies(b);d.controller.clear(d),d.controller.update(d,e,a,!0)}};var f=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.force.x=0,c.force.y=0,c.torque=0}},h=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.isStatic||d.isSleeping||(d.force.y+=d.mass*b.y*.001,d.force.x+=d.mass*b.x*.001)}},j=function(a,c,d,e,f){for(var g=0;g<a.length;g++){var h=a[g];h.isStatic||h.isSleeping||b.update(h,c,d,e)}}}();var p={};!function(){p.on=function(a,b,c){for(var d,e=b.split(" "),f=0;f<e.length;f++)d=e[f],a.events=a.events||{},a.events[d]=a.events[d]||[],a.events[d].push(c);return c},p.off=function(a,b,c){if(!b)return void(a.events={});"function"==typeof b&&(c=b,b=n.keys(a.events).join(" "));for(var d=b.split(" "),e=0;e<d.length;e++){var f=a.events[d[e]],g=[];if(c)for(var h=0;h<f.length;h++)f[h]!==c&&g.push(f[h]);a.events[d[e]]=g}},p.trigger=function(a,b,c){var d,e,f,g;if(a.events){c||(c={}),d=b.split(" ");for(var h=0;h<d.length;h++)if(e=d[h],f=a.events[e]){g=n.clone(c,!1),g.name=e,g.source=a;for(var i=0;i<f.length;i++)f[i].apply(a,[g])}}}}();var q={};!function(){q.create=function(){return{extended:!1,narrowDetections:0,narrowphaseTests:0,narrowReuse:0,narrowReuseCount:0,midphaseTests:0,broadphaseTests:0,narrowEff:1e-4,midEff:1e-4,broadEff:1e-4,collisions:0,buckets:0,bodies:0,pairs:0}},q.reset=function(a){a.extended&&(a.narrowDetections=0,a.narrowphaseTests=0,a.narrowReuse=0,a.narrowReuseCount=0,a.midphaseTests=0,a.broadphaseTests=0,a.narrowEff=0,a.midEff=0,a.broadEff=0,a.collisions=0,a.buckets=0,a.pairs=0,a.bodies=0)},q.update=function(a,b){if(a.extended){var d=b.world,e=c.allBodies(d);a.collisions=a.narrowDetections,a.pairs=b.pairs.list.length,a.bodies=e.length,a.midEff=(a.narrowDetections/(a.midphaseTests||1)).toFixed(2),a.narrowEff=(a.narrowDetections/(a.narrowphaseTests||1)).toFixed(2),a.broadEff=(1-a.broadphaseTests/(e.length||1)).toFixed(2),a.narrowReuse=(a.narrowReuseCount/(a.narrowphaseTests||1)).toFixed(2)}}}();var r={};!function(){var a=60,b=a,c=1e3/a,d=function(a){setTimeout(function(){a(n.now())},c)};r.run=function(a){var c,e=0,f=0,g=[],h=1;!function i(j){var k,l=a.timing,m=1;if(l.frameRequestId=d(i),a.enabled){var n={timestamp:j};p.trigger(a,"beforeTick",n),l.isFixed?k=l.delta:(k=j-c||l.delta,c=j,g.push(k),g=g.slice(-b),k=Math.min.apply(null,g),k=k<l.deltaMin?l.deltaMin:k,k=k>l.deltaMax?l.deltaMax:k,m=k/l.delta,l.delta=k),0!==h&&(m*=l.timeScale/h),0===l.timeScale&&(m=0),h=l.timeScale,f+=1,j-e>=1e3&&(l.fps=f*((j-e)/1e3),e=j,f=0),p.trigger(a,"tick",n),o.update(a,k,m),p.trigger(a,"afterTick",n)}}()},r.stop=function(a){}}();var s={};!function(){s._motionWakeThreshold=.18,s._motionSleepThreshold=.08,s._minBias=.9,s.update=function(a,b){for(var c=b*b*b,d=0;d<a.length;d++){
var e=a[d],f=e.speed*e.speed+e.angularSpeed*e.angularSpeed;if(0===e.force.x&&0===e.force.y){var g=Math.min(e.motion,f),h=Math.max(e.motion,f);e.motion=s._minBias*g+(1-s._minBias)*h,e.sleepThreshold>0&&e.motion<s._motionSleepThreshold*c?(e.sleepCounter+=1,e.sleepCounter>=e.sleepThreshold&&s.set(e,!0)):e.sleepCounter>0&&(e.sleepCounter-=1)}else s.set(e,!1)}},s.afterCollisions=function(a,b){for(var c=b*b*b,d=0;d<a.length;d++){var e=a[d];if(e.isActive){var f=e.collision,g=f.bodyA.parent,h=f.bodyB.parent;if(!(g.isSleeping&&h.isSleeping||g.isStatic||h.isStatic)&&(g.isSleeping||h.isSleeping)){var i=g.isSleeping&&!g.isStatic?g:h,j=i===g?h:g;!i.isStatic&&j.motion>s._motionWakeThreshold*c&&s.set(i,!1)}}}},s.set=function(a,b){var c=a.isSleeping;b?(a.isSleeping=!0,a.sleepCounter=a.sleepThreshold,a.positionImpulse.x=0,a.positionImpulse.y=0,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.anglePrev=a.angle,a.speed=0,a.angularSpeed=0,a.motion=0,c||p.trigger(a,"sleepStart")):(a.isSleeping=!1,a.sleepCounter=0,c&&p.trigger(a,"sleepEnd"))}}();var t={};!function(){t.rectangle=function(a,c,d,e,f){f=f||{};var g={label:"Rectangle Body",position:{x:a,y:c},vertices:z.fromPath("L 0 0 L "+d+" 0 L "+d+" "+e+" L 0 "+e)};if(f.chamfer){var h=f.chamfer;g.vertices=z.chamfer(g.vertices,h.radius,h.quality,h.qualityMin,h.qualityMax),delete f.chamfer}return b.create(n.extend({},g,f))},t.trapezoid=function(a,c,d,e,f,g){g=g||{},f*=.5;var h=(1-2*f)*d,i=d*f,j=i+h,k=j+i,l={label:"Trapezoid Body",position:{x:a,y:c},vertices:z.fromPath("L 0 0 L "+i+" "+-e+" L "+j+" "+-e+" L "+k+" 0")};if(g.chamfer){var m=g.chamfer;l.vertices=z.chamfer(l.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete g.chamfer}return b.create(n.extend({},l,g))},t.circle=function(a,b,c,d,e){d=d||{},d.label="Circle Body",e=e||25;var f=Math.ceil(Math.max(10,Math.min(e,c)));return f%2===1&&(f+=1),d.circleRadius=c,t.polygon(a,b,f,c,d)},t.polygon=function(a,c,d,e,f){if(f=f||{},3>d)return t.circle(a,c,e,f);for(var g=2*Math.PI/d,h="",i=.5*g,j=0;d>j;j+=1){var k=i+j*g,l=Math.cos(k)*e,m=Math.sin(k)*e;h+="L "+l.toFixed(3)+" "+m.toFixed(3)+" "}var o={label:"Polygon Body",position:{x:a,y:c},vertices:z.fromPath(h)};if(f.chamfer){var p=f.chamfer;o.vertices=z.chamfer(o.vertices,p.radius,p.quality,p.qualityMin,p.qualityMax),delete f.chamfer}return b.create(n.extend({},o,f))},t.fromVertices=function(a,c,d,e,f,g,h){var i,j,k,l,m,o,p,q,r;for(e=e||{},j=[],f="undefined"!=typeof f?f:!1,g="undefined"!=typeof g?g:.01,h="undefined"!=typeof h?h:10,window.decomp||n.log("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull.","warn"),n.isArray(d[0])||(d=[d]),q=0;q<d.length;q+=1)if(l=d[q],k=z.isConvex(l),k||!window.decomp)l=k?z.clockwiseSort(l):z.hull(l),j.push({position:{x:a,y:c},vertices:l});else{var s=new decomp.Polygon;for(m=0;m<l.length;m++)s.vertices.push([l[m].x,l[m].y]);s.makeCCW(),g!==!1&&s.removeCollinearPoints(g);var t=s.quickDecomp();for(m=0;m<t.length;m++){var u=t[m],v=[];for(o=0;o<u.vertices.length;o++)v.push({x:u.vertices[o][0],y:u.vertices[o][1]});h>0&&z.area(v)<h||j.push({position:z.centre(v),vertices:v})}}for(m=0;m<j.length;m++)j[m]=b.create(n.extend(j[m],e));if(f){var x=5;for(m=0;m<j.length;m++){var A=j[m];for(o=m+1;o<j.length;o++){var B=j[o];if(w.overlaps(A.bounds,B.bounds)){var C=A.vertices,D=B.vertices;for(p=0;p<A.vertices.length;p++)for(r=0;r<B.vertices.length;r++){var E=y.magnitudeSquared(y.sub(C[(p+1)%C.length],D[r])),F=y.magnitudeSquared(y.sub(C[p],D[(r+1)%D.length]));x>E&&x>F&&(C[p].isInternal=!0,D[r].isInternal=!0)}}}}}return j.length>1?(i=b.create(n.extend({parts:j.slice(0)},e)),b.setPosition(i,{x:a,y:c}),i):j[0]}}();var u={};!function(){u.stack=function(a,d,e,f,g,h,i){for(var j,k=c.create({label:"Stack"}),l=a,m=d,n=0,o=0;f>o;o++){for(var p=0,q=0;e>q;q++){var r=i(l,m,q,o,j,n);if(r){var s=r.bounds.max.y-r.bounds.min.y,t=r.bounds.max.x-r.bounds.min.x;s>p&&(p=s),b.translate(r,{x:.5*t,y:.5*s}),l=r.bounds.max.x+g,c.addBody(k,r),j=r,n+=1}else l+=g}m+=p+h,l=a}return k},u.chain=function(a,b,d,e,f,g){for(var h=a.bodies,i=1;i<h.length;i++){var j=h[i-1],k=h[i],l=j.bounds.max.y-j.bounds.min.y,o=j.bounds.max.x-j.bounds.min.x,p=k.bounds.max.y-k.bounds.min.y,q=k.bounds.max.x-k.bounds.min.x,r={bodyA:j,pointA:{x:o*b,y:l*d},bodyB:k,pointB:{x:q*e,y:p*f}},s=n.extend(r,g);c.addConstraint(a,m.create(s))}return a.label+=" Chain",a},u.mesh=function(a,b,d,e,f){var g,h,i,j,k,l=a.bodies;for(g=0;d>g;g++){for(h=1;b>h;h++)i=l[h-1+g*b],j=l[h+g*b],c.addConstraint(a,m.create(n.extend({bodyA:i,bodyB:j},f)));if(g>0)for(h=0;b>h;h++)i=l[h+(g-1)*b],j=l[h+g*b],c.addConstraint(a,m.create(n.extend({bodyA:i,bodyB:j},f))),e&&h>0&&(k=l[h-1+(g-1)*b],c.addConstraint(a,m.create(n.extend({bodyA:k,bodyB:j},f)))),e&&b-1>h&&(k=l[h+1+(g-1)*b],c.addConstraint(a,m.create(n.extend({bodyA:k,bodyB:j},f))))}return a.label+=" Mesh",a},u.pyramid=function(a,c,d,e,f,g,h){return u.stack(a,c,d,e,f,g,function(c,g,i,j,k,l){var m=Math.min(e,Math.ceil(d/2)),n=k?k.bounds.max.x-k.bounds.min.x:0;if(!(j>m)){j=m-j;var o=j,p=d-1-j;if(!(o>i||i>p)){1===l&&b.translate(k,{x:(i+(d%2===1?1:-1))*n,y:0});var q=k?i*n:0;return h(a+q+i*f,g,i,j,k,l)}}})},u.newtonsCradle=function(a,b,d,e,f){for(var g=c.create({label:"Newtons Cradle"}),h=0;d>h;h++){var i=1.9,j=t.circle(a+h*e*i,b+f,e,{inertia:99999,restitution:1,friction:0,frictionAir:1e-4,slop:.01}),k=m.create({pointA:{x:a+h*e*i,y:b},bodyB:j});c.addBody(g,j),c.addConstraint(g,k)}return g},u.car=function(a,d,e,f,g){var h=b.nextGroup(!0),i=-20,j=.5*-e+i,k=.5*e-i,l=0,n=c.create({label:"Car"}),o=t.trapezoid(a,d,e,f,.3,{collisionFilter:{group:h},friction:.01,chamfer:{radius:10}}),p=t.circle(a+j,d+l,g,{collisionFilter:{group:h},restitution:.5,friction:.9,frictionStatic:10,slop:.5,density:.01}),q=t.circle(a+k,d+l,g,{collisionFilter:{group:h},restitution:.5,friction:.9,frictionStatic:10,slop:.5,density:.01}),r=m.create({bodyA:o,pointA:{x:j,y:l},bodyB:p,stiffness:.5}),s=m.create({bodyA:o,pointA:{x:k,y:l},bodyB:q,stiffness:.5});return c.addBody(n,o),c.addBody(n,p),c.addBody(n,q),c.addConstraint(n,r),c.addConstraint(n,s),n},u.softBody=function(a,b,c,d,e,f,g,h,i,j){i=n.extend({inertia:1/0},i),j=n.extend({stiffness:.4},j);var k=u.stack(a,b,c,d,e,f,function(a,b){return t.circle(a,b,h,i)});return u.mesh(k,c,d,g,j),k.label="Soft Body",k}}();var v={};!function(){v.fromVertices=function(a){for(var b={},c=0;c<a.length;c++){var d=(c+1)%a.length,e=y.normalise({x:a[d].y-a[c].y,y:a[c].x-a[d].x}),f=0===e.y?1/0:e.x/e.y;f=f.toFixed(3).toString(),b[f]=e}return n.values(b)},v.rotate=function(a,b){if(0!==b)for(var c=Math.cos(b),d=Math.sin(b),e=0;e<a.length;e++){var f,g=a[e];f=g.x*c-g.y*d,g.y=g.x*d+g.y*c,g.x=f}}}();var w={};!function(){w.create=function(a){var b={min:{x:0,y:0},max:{x:0,y:0}};return a&&w.update(b,a),b},w.update=function(a,b,c){a.min.x=Number.MAX_VALUE,a.max.x=Number.MIN_VALUE,a.min.y=Number.MAX_VALUE,a.max.y=Number.MIN_VALUE;for(var d=0;d<b.length;d++){var e=b[d];e.x>a.max.x&&(a.max.x=e.x),e.x<a.min.x&&(a.min.x=e.x),e.y>a.max.y&&(a.max.y=e.y),e.y<a.min.y&&(a.min.y=e.y)}c&&(c.x>0?a.max.x+=c.x:a.min.x+=c.x,c.y>0?a.max.y+=c.y:a.min.y+=c.y)},w.contains=function(a,b){return b.x>=a.min.x&&b.x<=a.max.x&&b.y>=a.min.y&&b.y<=a.max.y},w.overlaps=function(a,b){return a.min.x<=b.max.x&&a.max.x>=b.min.x&&a.max.y>=b.min.y&&a.min.y<=b.max.y},w.translate=function(a,b){a.min.x+=b.x,a.max.x+=b.x,a.min.y+=b.y,a.max.y+=b.y},w.shift=function(a,b){var c=a.max.x-a.min.x,d=a.max.y-a.min.y;a.min.x=b.x,a.max.x=b.x+c,a.min.y=b.y,a.max.y=b.y+d}}();var x={};!function(){x.pathToVertices=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=[],q=0,r=0,s=0;c=c||15;var t=function(a,b,c){var d=c%2===1&&c>1;if(!l||a!=l.x||b!=l.y){l&&d?(n=l.x,o=l.y):(n=0,o=0);var e={x:n+a,y:o+b};(d||!l)&&(l=e),p.push(e),r=n+a,s=o+b}},u=function(a){var b=a.pathSegTypeAsLetter.toUpperCase();if("Z"!==b){switch(b){case"M":case"L":case"T":case"C":case"S":case"Q":r=a.x,s=a.y;break;case"H":r=a.x;break;case"V":s=a.y}t(r,s,a.pathSegType)}};for(a(b),f=b.getTotalLength(),i=[],d=0;d<b.pathSegList.numberOfItems;d+=1)i.push(b.pathSegList.getItem(d));for(j=i.concat();f>q;){if(m=b.getPathSegAtLength(q),h=i[m],h!=k){for(;j.length&&j[0]!=h;)u(j.shift());k=h}switch(h.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":g=b.getPointAtLength(q),t(g.x,g.y,0)}q+=c}for(d=0,e=j.length;e>d;++d)u(j[d]);return p};var a=function(a){for(var b,c,d,e,f,g,h=a.pathSegList,i=0,j=0,k=h.numberOfItems,l=0;k>l;++l){var m=h.getItem(l),n=m.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(n))"x"in m&&(i=m.x),"y"in m&&(j=m.y);else switch("x1"in m&&(d=i+m.x1),"x2"in m&&(f=i+m.x2),"y1"in m&&(e=j+m.y1),"y2"in m&&(g=j+m.y2),"x"in m&&(i+=m.x),"y"in m&&(j+=m.y),n){case"m":h.replaceItem(a.createSVGPathSegMovetoAbs(i,j),l);break;case"l":h.replaceItem(a.createSVGPathSegLinetoAbs(i,j),l);break;case"h":h.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(i),l);break;case"v":h.replaceItem(a.createSVGPathSegLinetoVerticalAbs(j),l);break;case"c":h.replaceItem(a.createSVGPathSegCurvetoCubicAbs(i,j,d,e,f,g),l);break;case"s":h.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(i,j,f,g),l);break;case"q":h.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(i,j,d,e),l);break;case"t":h.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(i,j),l);break;case"a":h.replaceItem(a.createSVGPathSegArcAbs(i,j,m.r1,m.r2,m.angle,m.largeArcFlag,m.sweepFlag),l);break;case"z":case"Z":i=b,j=c}("M"==n||"m"==n)&&(b=i,c=j)}}}();var y={};!function(){y.create=function(a,b){return{x:a||0,y:b||0}},y.clone=function(a){return{x:a.x,y:a.y}},y.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},y.magnitudeSquared=function(a){return a.x*a.x+a.y*a.y},y.rotate=function(a,b){var c=Math.cos(b),d=Math.sin(b);return{x:a.x*c-a.y*d,y:a.x*d+a.y*c}},y.rotateAbout=function(a,b,c,d){var e=Math.cos(b),f=Math.sin(b);d||(d={});var g=c.x+((a.x-c.x)*e-(a.y-c.y)*f);return d.y=c.y+((a.x-c.x)*f+(a.y-c.y)*e),d.x=g,d},y.normalise=function(a){var b=y.magnitude(a);return 0===b?{x:0,y:0}:{x:a.x/b,y:a.y/b}},y.dot=function(a,b){return a.x*b.x+a.y*b.y},y.cross=function(a,b){return a.x*b.y-a.y*b.x},y.cross3=function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x)},y.add=function(a,b,c){return c||(c={}),c.x=a.x+b.x,c.y=a.y+b.y,c},y.sub=function(a,b,c){return c||(c={}),c.x=a.x-b.x,c.y=a.y-b.y,c},y.mult=function(a,b){return{x:a.x*b,y:a.y*b}},y.div=function(a,b){return{x:a.x/b,y:a.y/b}},y.perp=function(a,b){return b=b===!0?-1:1,{x:b*-a.y,y:b*a.x}},y.neg=function(a){return{x:-a.x,y:-a.y}},y.angle=function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},y._temp=[y.create(),y.create(),y.create(),y.create(),y.create(),y.create()]}();var z={};!function(){z.create=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f={x:e.x,y:e.y,index:d,body:b,isInternal:!1};c.push(f)}return c},z.fromPath=function(a,b){var c=/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,d=[];return a.replace(c,function(a,b,c){d.push({x:parseFloat(b),y:parseFloat(c)})}),z.create(d,b)},z.centre=function(a){for(var b,c,d,e=z.area(a,!0),f={x:0,y:0},g=0;g<a.length;g++)d=(g+1)%a.length,b=y.cross(a[g],a[d]),c=y.mult(y.add(a[g],a[d]),b),f=y.add(f,c);return y.div(f,6*e)},z.mean=function(a){for(var b={x:0,y:0},c=0;c<a.length;c++)b.x+=a[c].x,b.y+=a[c].y;return y.div(b,a.length)},z.area=function(a,b){for(var c=0,d=a.length-1,e=0;e<a.length;e++)c+=(a[d].x-a[e].x)*(a[d].y+a[e].y),d=e;return b?c/2:Math.abs(c)/2},z.inertia=function(a,b){for(var c,d,e=0,f=0,g=a,h=0;h<g.length;h++)d=(h+1)%g.length,c=Math.abs(y.cross(g[d],g[h])),e+=c*(y.dot(g[d],g[d])+y.dot(g[d],g[h])+y.dot(g[h],g[h])),f+=c;return b/6*(e/f)},z.translate=function(a,b,c){var d;if(c)for(d=0;d<a.length;d++)a[d].x+=b.x*c,a[d].y+=b.y*c;else for(d=0;d<a.length;d++)a[d].x+=b.x,a[d].y+=b.y;return a},z.rotate=function(a,b,c){if(0!==b){for(var d=Math.cos(b),e=Math.sin(b),f=0;f<a.length;f++){var g=a[f],h=g.x-c.x,i=g.y-c.y;g.x=c.x+(h*d-i*e),g.y=c.y+(h*e+i*d)}return a}},z.contains=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=a[(c+1)%a.length];if((b.x-d.x)*(e.y-d.y)+(b.y-d.y)*(d.x-e.x)>0)return!1}return!0},z.scale=function(a,b,c,d){if(1===b&&1===c)return a;d=d||z.centre(a);for(var e,f,g=0;g<a.length;g++)e=a[g],f=y.sub(e,d),a[g].x=d.x+f.x*b,a[g].y=d.y+f.y*c;return a},z.chamfer=function(a,b,c,d,e){b=b||[8],b.length||(b=[b]),c="undefined"!=typeof c?c:-1,d=d||2,e=e||14;for(var f=[],g=0;g<a.length;g++){var h=a[g-1>=0?g-1:a.length-1],i=a[g],j=a[(g+1)%a.length],k=b[g<b.length?g:b.length-1];if(0!==k){var l=y.normalise({x:i.y-h.y,y:h.x-i.x}),m=y.normalise({x:j.y-i.y,y:i.x-j.x}),o=Math.sqrt(2*Math.pow(k,2)),p=y.mult(n.clone(l),k),q=y.normalise(y.mult(y.add(l,m),.5)),r=y.sub(i,y.mult(q,o)),s=c;-1===c&&(s=1.75*Math.pow(k,.32)),s=n.clamp(s,d,e),s%2===1&&(s+=1);for(var t=Math.acos(y.dot(l,m)),u=t/s,v=0;s>v;v++)f.push(y.add(y.rotate(p,u*v),r))}else f.push(i)}return f},z.clockwiseSort=function(a){var b=z.mean(a);return a.sort(function(a,c){return y.angle(b,a)-y.angle(b,c)}),a},z.isConvex=function(a){var b,c,d,e,f=0,g=a.length;if(3>g)return null;for(b=0;g>b;b++)if(c=(b+1)%g,d=(b+2)%g,e=(a[c].x-a[b].x)*(a[d].y-a[c].y),e-=(a[c].y-a[b].y)*(a[d].x-a[c].x),0>e?f|=1:e>0&&(f|=2),3===f)return!1;return 0!==f?!0:null},z.hull=function(a){var b,c,d=[],e=[];for(a=a.slice(0),a.sort(function(a,b){var c=a.x-b.x;return 0!==c?c:a.y-b.y}),c=0;c<a.length;c++){for(b=a[c];e.length>=2&&y.cross3(e[e.length-2],e[e.length-1],b)<=0;)e.pop();e.push(b)}for(c=a.length-1;c>=0;c--){for(b=a[c];d.length>=2&&y.cross3(d[d.length-2],d[d.length-1],b)<=0;)d.pop();d.push(b)}return d.pop(),e.pop(),d.concat(e)}}(),d.add=c.add,d.remove=c.remove,d.addComposite=c.addComposite,d.addBody=c.addBody,d.addConstraint=c.addConstraint,d.clear=c.clear,o.run=r.run,a.Body=b,a.Composite=c,a.World=d,a.Contact=e,a.Detector=f,a.Grid=g,a.Pairs=i,a.Pair=h,a.Resolver=k,a.SAT=l,a.Constraint=m,a.Common=n,a.Engine=o,a.Sleeping=s,a.Bodies=t,a.Composites=u,a.Axes=v,a.Bounds=w,a.Vector=y,a.Vertices=z,a.Events=p,a.Query=j,a.Runner=r,a.Svg=x,a.Metrics=q,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.Matter=a),"function"==typeof define&&define.amd&&define("Matter",[],function(){return a}),"object"==typeof window&&"object"==typeof window.document&&(window.Matter=a)}();